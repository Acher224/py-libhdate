language: python
cache: pip
matrix:
  include:
  - python: '2.7'
    env:
    - TOXENV=py27,report,coveralls,codecov
  - python: '3.6'
    env:
    - TOXENV=check,py36,report,coveralls,codecov
  - python: '3.7'
    env:
    - TOXENV=py37,report,coveralls,codecov
install:
- pip install tox
script:
- tox -v

deploy:
  - provider: releases
    api_key:
      secure: $GITHUB_DEPLOYMENT_KEY
    file_glob: true
    file: dist/*
    skip_cleanup: true
    on:
      tags: true
  - provider: pypi
    user: __token__
    distributions: sdist bdist_wheel
    skip_existing: true
    password:
      secure: $PYPI_DEPLOYMENT_KEY
    on:
      tags: true
